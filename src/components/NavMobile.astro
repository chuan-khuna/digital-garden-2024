---
import ThemeToggle from '@/components/ThemeToggle.astro'
import { Button } from '@/components/ui/button'
import { Menu, X as Close } from 'lucide-react'
import { getCollection } from 'astro:content'

const navItems = await getCollection('navItems')
const sortedNavItems = navItems.sort((a, b) => a.data.order - b.data.order)
---

<nav
  class="fixed right-4 top-2 z-[5000] flex max-w-fit items-center justify-end space-x-2 rounded-full bg-transparent py-1 pl-2 pr-2 supports-[backdrop-filter]:bg-background/10 md:hidden"
>
  <ThemeToggle />
  <Button variant="ghost" size="icon" id="mobile-nav">
    <Menu className="h-[1.5rem] w-[1.3rem]" id="nav-hamburger" />
    <Close className="hidden h-[1.5rem] w-[1.3rem]" id="nav-close" />
  </Button>
</nav>

<!-- mobile nav menu -->
<div id="mobile-nav-container" class="hidden w-full">
  <div class="flex flex-col md:hidden">
    {
      sortedNavItems.map((item) => (
        <a href={item.data.link} class="mx-auto py-2">
          {item.data.label}
        </a>
      ))
    }
  </div>
</div>

<script>
  const mobileNavContainer = document.getElementById('mobile-nav-container')
  const navButton = document.getElementById('mobile-nav')
  const hamburgerIcon = document.getElementById('nav-hamburger')
  const closeIcon = document.getElementById('nav-close')

  const handleNavClick = () => {
    hamburgerIcon?.classList.toggle('hidden')
    closeIcon?.classList.toggle('hidden')
    mobileNavContainer?.classList.toggle('hidden')
  }

  navButton?.addEventListener('click', handleNavClick)
</script>